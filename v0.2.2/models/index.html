<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Models · WhittleLikelihoodInference.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><script src="../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WhittleLikelihoodInference.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../background/">Background</a></li><li><a class="tocitem" href="../starting/">Getting Started</a></li><li class="is-active"><a class="tocitem" href>Models</a><ul class="internal"><li><a class="tocitem" href="#Generic-model-framework"><span>Generic model framework</span></a></li><li><a class="tocitem" href="#Included-models"><span>Included models</span></a></li></ul></li><li><span class="tocitem">Likelihood functions</span><ul><li><a class="tocitem" href="../WhittleLikelihood/">Whittle likelihood</a></li><li><a class="tocitem" href="../debiasedwhittlelikelihood/">Debiased Whittle likelihood</a></li></ul></li><li><a class="tocitem" href="../docstrings/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Models</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JakeGrainger/WhittleLikelihoodInference.jl/blob/master/docs/src/models.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Models"><a class="docs-heading-anchor" href="#Models">Models</a><a id="Models-1"></a><a class="docs-heading-anchor-permalink" href="#Models" title="Permalink"></a></h1><h2 id="Generic-model-framework"><a class="docs-heading-anchor" href="#Generic-model-framework">Generic model framework</a><a id="Generic-model-framework-1"></a><a class="docs-heading-anchor-permalink" href="#Generic-model-framework" title="Permalink"></a></h2><p>Models for time series in <code>WhittleLikelihoodInference</code> are specified by defining a new type which is a subtype of <code>TimeSeriesModel{D,T}</code> where <code>D</code> is the dimension of the time series and <code>T</code> is the type of the entry in the time series (i.e. Float64 for real valued and ComplexF64 for complex valued).</p><h3 id="Univariate"><a class="docs-heading-anchor" href="#Univariate">Univariate</a><a id="Univariate-1"></a><a class="docs-heading-anchor-permalink" href="#Univariate" title="Permalink"></a></h3><p>So if we wish to define a univariate time series model which is real valued, we would write the following:</p><pre><code class="language-julia hljs">struct MyUniModel &lt;: TimeSeriesModel{1,Float64}
    α::Float64
    β::Float64
end</code></pre><p>In this case, we created a model called <code>MyUniModel</code> with parameters <code>α</code> and <code>β</code>. We then need to define the <code>npars</code> function to return the number of parameters, and <code>sdf</code> and <code>acv</code>.</p><h3 id="Multivariate"><a class="docs-heading-anchor" href="#Multivariate">Multivariate</a><a id="Multivariate-1"></a><a class="docs-heading-anchor-permalink" href="#Multivariate" title="Permalink"></a></h3><p>Similarly, if we wish to define a bivariate real model, we write</p><pre><code class="language-julia hljs">struct My2dModel &lt;: TimeSeriesModel{2,Float64}
    α::Float64
    β::Float64
end</code></pre><p>In this case, we again need to define the <code>npars</code> function to return the number of parameters, and now <code>add_sdf!</code> and <code>acv!</code>. <code>add_sdf!</code> takes a preallocated vector as its first argument. This vector is the lower triangle of the spectral density matrix at <span>$\omega$</span>, and the spectral density should be added to it. The lower triangle is encoded so that it goes down each column in order, i.e. in the case <code>D=2</code> we have <span>$[s_{1,1},s_{2,1},s_{2,2}]$</span>. The remaining entries are recovered by conjugate symmetry. <code>acv!</code> is analogous, but the acv replaces the preallocated vector, and not added to it.</p><h3 id="Unknown-autocovariance"><a class="docs-heading-anchor" href="#Unknown-autocovariance">Unknown autocovariance</a><a id="Unknown-autocovariance-1"></a><a class="docs-heading-anchor-permalink" href="#Unknown-autocovariance" title="Permalink"></a></h3><p>Sometimes, the autocovariance may not be known analytically (or may be expensive to compute). In this case, the autocovariance can be approximated from the spectral density function. To specify such a model, do the following:</p><pre><code class="language-julia hljs">struct MyUnknownExample &lt;: UnknownAcvTimeSeriesModel{D} end</code></pre><p>Then only <code>npars</code> and <code>add_sdf!</code> (<code>sdf</code> if univariate) need to be specified.</p><h3 id="Gradients-and-Hessians"><a class="docs-heading-anchor" href="#Gradients-and-Hessians">Gradients and Hessians</a><a id="Gradients-and-Hessians-1"></a><a class="docs-heading-anchor-permalink" href="#Gradients-and-Hessians" title="Permalink"></a></h3><p>To use gradient and Hessian features the functions <code>grad_add_sdf!</code>, <code>grad_acv!</code>, <code>hess_add_sdf!</code> and <code>hess_acv!</code> need to be specified (the acv versions should not be specified if the model is a <code>UnknownAcvTimeSeriesModel</code>.)</p><p>For the gradient, the preallocated vector has first dimension the size of the lower triangle of the spectral density matrix, and second dimension the number of parameters. The Hessian is similar, but the second dimension is the lower triangle of the Hessian matrix, encoded in the same was as the lower triangle of the spectral density matrix.</p><h2 id="Included-models"><a class="docs-heading-anchor" href="#Included-models">Included models</a><a id="Included-models-1"></a><a class="docs-heading-anchor-permalink" href="#Included-models" title="Permalink"></a></h2><p>This package includes some basic models with both gradients and Hessians specified.</p><h3 id="OU"><a class="docs-heading-anchor" href="#OU">OU</a><a id="OU-1"></a><a class="docs-heading-anchor-permalink" href="#OU" title="Permalink"></a></h3><p>The first model is a stationary OU process, with autocovariance</p><p class="math-container">\[c_{X}(\tau) = \frac{\sigma^2}{\theta}\exp\{-\theta|\tau|\}\]</p><p>and spectral density function</p><p class="math-container">\[f_{X}(\omega) = \frac{\sigma^2}{\pi(\theta^2+\omega^2)}.\]</p><p>The OU process can be constructed by using</p><pre><code class="language-julia hljs">OU(σ,θ)</code></pre><h3 id="CorrelatedOU"><a class="docs-heading-anchor" href="#CorrelatedOU">CorrelatedOU</a><a id="CorrelatedOU-1"></a><a class="docs-heading-anchor-permalink" href="#CorrelatedOU" title="Permalink"></a></h3><p>Consider two independent OU processes <span>$X_1$</span> and <span>$X_2$</span> with the same <span>$\sigma$</span> and <span>$\theta$</span> parameters. Then define <span>$Y_1 = X_1$</span> and <span>$Y_2 = \rho X_1 + \sqrt{1-\rho^2}X_2$</span>. Then we say that <span>$Y=[Y_1,Y_2]^T$</span> is a correlated OU process. We have that</p><p class="math-container">\[\mathbb{E}[Y_1(\tau)Y_1(0)] = c_{X}(\tau)\]</p><p>and</p><p class="math-container">\[\begin{align*} 
    \mathbb{E}[Y_2(\tau)Y_2(0)] &amp;= \rho^2\mathbb{E}[X_1(\tau)X_1(0)] + (1-\rho^2)\mathbb{E}[X_2(\tau)X_2(0)]\\
    &amp;= c_{X}(\tau)
\end{align*}\]</p><p>and</p><p class="math-container">\[\begin{align*} 
    \mathbb{E}[Y_2(\tau)Y_1(0)] &amp;= \rho c_{X}(\tau)
\end{align*}.\]</p><p>Therefore, we have</p><p class="math-container">\[\begin{align*}
    c_{Y}(\tau) = \begin{bmatrix}
        c_X(\tau) &amp; \rho c_X(\tau) \\
        \rho c_X(\tau) &amp; c_X(\tau)
    \end{bmatrix},
\end{align*}\]</p><p>and</p><p class="math-container">\[\begin{align*}
    f_{Y}(\omega) = \begin{bmatrix}
        f_X(\omega) &amp; \rho f_X(\omega) \\
        \rho f_X(\omega) &amp; f_X(\omega)
    \end{bmatrix}.
\end{align*}\]</p><p>So we have taken two OU processes and correlated them with correlation parameter <span>$\rho$</span>. This correlated OU process can be constructed in julia with the following:</p><pre><code class="language-julia hljs">CorrelatedOU(σ,θ,ρ)</code></pre><h3 id="Matern"><a class="docs-heading-anchor" href="#Matern">Matern</a><a id="Matern-1"></a><a class="docs-heading-anchor-permalink" href="#Matern" title="Permalink"></a></h3><p>The package also includes an implementation of the multivariate Matérn model described by Gneiting et al. (2010). Care should be taken when using this model to ensure the correct bounds are placed on the parameter space.</p><h3 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h3><p>Gneiting, T., Kleiber, W., &amp; Schlather, M. (2010). Matérn cross-covariance functions for multivariate random fields. Journal of the American Statistical Association, 105(491), 1167-1177.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../starting/">« Getting Started</a><a class="docs-footer-nextpage" href="../WhittleLikelihood/">Whittle likelihood »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Thursday 24 February 2022 12:51">Thursday 24 February 2022</span>. Using Julia version 1.6.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
